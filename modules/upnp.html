<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head>
    <title>upnp: Module Index</title>
    <link rel="stylesheet" href="../luadoc.css" type="text/css" />
    <!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
</head>

<body>
<div id="container">

<div id="product">
    <div id="product_logo"></div>
    <div id="product_name"><big><b></b></big></div>
    <div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h2>LuaDoc</h2>
<ul>
	
	<li><a href="../index.html">Index</a></li>
	
</ul>


<!-- Module list -->

<h2>Modules</h2>
<ul>

	<li><strong>upnp</strong></li>
	
	<li>
		<a href="../modules/upnp.bootstrap.html">upnp.bootstrap</a>
	</li>

	<li>
		<a href="../modules/upnp.classes.action.html">upnp.classes.action</a>
	</li>

	<li>
		<a href="../modules/upnp.classes.argument.html">upnp.classes.argument</a>
	</li>

	<li>
		<a href="../modules/upnp.classes.device.html">upnp.classes.device</a>
	</li>

	<li>
		<a href="../modules/upnp.classes.service.html">upnp.classes.service</a>
	</li>

	<li>
		<a href="../modules/upnp.classes.statevariable.html">upnp.classes.statevariable</a>
	</li>

	<li>
		<a href="../modules/upnp.classes.upnpbase.html">upnp.classes.upnpbase</a>
	</li>

	<li>
		<a href="../modules/upnp.devicefactory.html">upnp.devicefactory</a>
	</li>

	<li>
		<a href="../modules/upnp.drivers.driver-template.html">upnp.drivers.driver-template</a>
	</li>

	<li>
		<a href="../modules/upnp.drivers.xplrfx.html">upnp.drivers.xplrfx</a>
	</li>

	<li>
		<a href="../modules/upnp.lp.html">upnp.lp</a>
	</li>

	<li>
		<a href="../modules/upnp.xmlfactory.html">upnp.xmlfactory</a>
	</li>

	<li>
		<a href="../modules/urn_schemas-upnp-org_device_BinaryLight_1.html">urn_schemas-upnp-org_device_BinaryLight_1</a>
	</li>

	<li>
		<a href="../modules/urn_schemas-upnp-org_device_DimmableLight_1.html">urn_schemas-upnp-org_device_DimmableLight_1</a>
	</li>

	<li>
		<a href="../modules/urn_schemas-upnp-org_service_Dimming_1.html">urn_schemas-upnp-org_service_Dimming_1</a>
	</li>

	<li>
		<a href="../modules/urn_schemas-upnp-org_service_SwitchPower_1.html">urn_schemas-upnp-org_service_SwitchPower_1</a>
	</li>

</ul>



<!-- File list -->






</div><!-- id="navigation" -->

<div id="content">

<h1>Module "<code>upnp</code>"</h1>

<p>LuaUPnP is a binding for the pupnp library for Lua. <br/>The library has dependencies on <a href="http://luasocket.luaforge.net/">LuaSocket</a>, <a href="http://keplerproject.github.com/copas/">Copas</a>, <a href="http://github.com/Tieske/CopasTimer">CopasTimer</a>, <a href="http://www.keplerproject.org/lualogging/">LuaLogging</a>, <a href="http://luaforge.net/projects/date/">date</a>, <a href="http://loop.luaforge.net/">Loop</a>, <a href="http://github.com/Tieske/DarkSideSync">DarkSideSync</a> and <a href="http://pupnp.sourceforge.net/">pupnp</a>. When 'required' it will load all required modules, the core UPnP library, all devices classes, etc. Only devices need to be set up before calling <code>copas.loop()</code> to start the scheduler. <br/>A global <code>upnp</code> will be created and it will be returned. <br/><br/><strong>Note</strong>: the global <code>print()</code> function will be remapped to the logger, so everything printed will be logged at the <code>info</code> level.</p>


<p>Copyright &copy; 2012 <a href="http://www.thijsschreijer.nl">Thijs Schreijer</a>, <a href="http://github.com/Tieske/LuaUPnP">LuaUPnP</a> is licensed under <a href="http://www.gnu.org/licenses/gpl-3.0.html">GPLv3</a></p>


<p><small><b>Release:</b> Version 0.x, LuaUPnP.</small></p>



<h2>Tables</h2>
<table class="table_list">

	<tr>
	<td class="name" nowrap><a href="#upnp members and namespaces">upnp members and namespaces</a></td>
	<td class="summary">List of members and namespaces within LuaUPnP.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#upnp.events">upnp.events</a></td>
	<td class="summary">Events generated by upnp library for starting and stopping.</td>
	</tr>

</table>



<h2>Functions</h2>
<table class="function_list">

    <tr>
    <td class="name" nowrap><a href="#getconfigfilename">getconfigfilename</a>&nbsp;(configname)</td>
    <td class="summary">Takes a config filename and returns the path to the file to open.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#os.exit">os.exit</a>&nbsp;(...)</td>
    <td class="summary">wraps original os.exit() function to make sure UPnP lib is always properly stopped </td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.existsconfigfile">upnp.existsconfigfile</a>&nbsp;(configname)</td>
    <td class="summary">Does a configfile exist.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.getxml">upnp.getxml</a>&nbsp;(xmldoc)</td>
    <td class="summary">Gets an xml document.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.lib.util.CreateUUID">upnp.lib.util.CreateUUID</a>&nbsp;()</td>
    <td class="summary">wraps original function to work even when library is not started </td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.readconfigfile">upnp.readconfigfile</a>&nbsp;(configname, defaults)</td>
    <td class="summary">Read a configfile.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.startdevice">upnp.startdevice</a>&nbsp;(rootdev)</td>
    <td class="summary">Starts a UPnP device.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.stopdevice">upnp.stopdevice</a>&nbsp;(hdl)</td>
    <td class="summary">Stops a UPnP device.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.subscribe">upnp.subscribe</a>&nbsp;()</td>
    <td class="summary">Subscribe to events of upnp library.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.unsubscribe">upnp.unsubscribe</a>&nbsp;()</td>
    <td class="summary">Unsubscribe from events of upnp library.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#upnp.writeconfigfile">upnp.writeconfigfile</a>&nbsp;(configname, content, comment)</td>
    <td class="summary">Write a configfile.</td>
    </tr>

</table>


<br/>
<br/>


<h2><a name="tables"></a>Tables</h2>
<dl class="table">

<dt><a name="upnp members and namespaces"></a><strong>upnp members and namespaces</strong></dt>
<dd>List of members and namespaces within LuaUPnP.


<h3>Fields</h3>
<ul>
	
	<li>
	  <code><em>classes</em></code>: holds a list of classes for upnp devices; upnpbase, device, service, etc.
	</li>
	
	<li>
	  <code><em>devices</em></code>: list of registered devices indexed by their UDN
	</li>
	
	<li>
	  <code><em>logger</em></code>: the logger in use by the upnp module (all <code>print()</code> commands will be rerouted here)
	</li>
	
	<li>
	  <code><em>webroot</em></code>: path of the web-root directory
	</li>
	
	<li>
	  <code><em>baseurl</em></code>: base url pointing to the web-root directory
	</li>
	
	<li>
	  <code><em>configroot</em></code>: base directory for configuration information
	</li>
	
	<li>
	  <code><em>lib</em></code>: contains the mapped functions of pupnp library
	</li>
	
	<li>
	  <code><em>lib.web</em></code>: contains the mapped functions of upnp web methods
	</li>
	
	<li>
	  <code><em>lib.http</em></code>: contains the mapped functions of upnp http methods
	</li>
	
	<li>
	  <code><em>lib.util</em></code>: contains the mapped functions of upnp util methods + CreateUUID
	</li>
	
	<li>
	  <code><em>lib.ixml</em></code>: contains the mapped functions of upnp ixml methods
	</li>
	
</ul>







</dd>


<dt><a name="upnp.events"></a><strong>upnp.events</strong></dt>
<dd>Events generated by upnp library for starting and stopping. Besides these events there are additional events from <code>copas</code> as that scheduler is used (see 'CopasTimer' and specifically the <code>copas.eventer</code> module).


<h3>Fields</h3>
<ul>
	
	<li>
	  <code><em>UPnPstarting</em></code>: This event is started on the <code>copas.events.loopstarted</code> event and executes before any UPnP code is being run. Only when this event is complete (all handlers spawned have finished) the UPnP code will start. Use this event to setup any UPnP devices.
	</li>
	
	<li>
	  <code><em>UPnPstarted</em></code>: Runs after the UPnP library has been initiated and is running. The device object typically start themselves on this event and will announce themselves.
	</li>
	
	<li>
	  <code><em>UPnPstopping</em></code>: This event is started from the <code>copas.events.loopstopping</code> event and executes before any UPnP code is being torn down. Only when this event is complete (all handlers spawned have finished) the UPnP code will initiate the teardown. The device object typically will stop itself on this event.
	</li>
	
	<li>
	  <code><em>UPnPstopped</em></code>: Runs after the UPnP code has been stopped
	</li>
	
</ul>





<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="modules/upnp.html#upnp.subscribe">
		upnp.subscribe
	</a></li>
	
	<li><a href="modules/upnp.html#upnp.unsubscribe">
		upnp.unsubscribe
	</a></li>
	
</ul>

</div>



</dd>


</dl>



<h2><a name="functions"></a>Functions</h2>
<dl class="function">



<dt><a name="getconfigfilename"></a><strong>getconfigfilename</strong>&nbsp;(configname)</dt>
<dd>
Takes a config filename and returns the path to the file to open. An automatic extension <code>'.config'</code> will be appended.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>configname</em></code>: filename of configfile (only the filename part of a path will be used, path and <code>'.config'</code> extension will stripped from the provided name)
	</li>
	
</ul>





<div>


<h3 class="inline-block">Return value:</h3>
path to config file, being <code>upnp.configroot</code> combined with the config filename

</div>






<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="#upnp members and namespaces">
		upnp.configroot
	</a></li>
	
</ul>

</div>


</dd>




<dt><a name="os.exit"></a><strong>os.exit</strong>&nbsp;(...)</dt>
<dd>
wraps original os.exit() function to make sure UPnP lib is always properly stopped


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>...</em></code>: 
	</li>
	
</ul>











</dd>




<dt><a name="upnp.existsconfigfile"></a><strong>upnp.existsconfigfile</strong>&nbsp;(configname)</dt>
<dd>
Does a configfile exist.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>configname</em></code>: configuration filename to check.
	</li>
	
</ul>





<div>


<h3 class="inline-block">Return value:</h3>
boolean

</div>






<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="#upnp members and namespaces">
		upnp.configroot
	</a></li>
	
	<li><a href="../modules/upnp.html#upnp.readconfigfile">
		upnp.readconfigfile
	</a></li>
	
	<li><a href="../modules/upnp.html#upnp.writeconfigfile">
		upnp.writeconfigfile
	</a></li>
	
</ul>

</div>


</dd>




<dt><a name="upnp.getxml"></a><strong>upnp.getxml</strong>&nbsp;(xmldoc)</dt>
<dd>
Gets an xml document. It will try to get the xml from several things; 1) filename, 2) literal xml, 3) IXML object. If a filename is given, it will first try to open, if it fails it will try again relative to the <code>upnp.webroot</code> directory.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>xmldoc</em></code>: either 1) filename, 2) literal xml, 3) IXML object
	</li>
	
</ul>





<div>


<h3 class="inline-block">Return value:</h3>
IXML object or <code>nil + errormessage</code>

</div>







</dd>




<dt><a name="upnp.lib.util.CreateUUID"></a><strong>upnp.lib.util.CreateUUID</strong>&nbsp;()</dt>
<dd>
wraps original function to work even when library is not started












</dd>




<dt><a name="upnp.readconfigfile"></a><strong>upnp.readconfigfile</strong>&nbsp;(configname, defaults)</dt>
<dd>
Read a configfile. The configfile must be a lua table format, starting with '<code> return {</code>' and ending with '<code>}</code>'.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>configname</em></code>: configuration filename to load. This should only be a filename (no path), and it will be sought for in the <code>upnp.configroot</code> directory.
	</li>
	
	<li>
	  <code><em>defaults</em></code>: table with defaults to return when the configfile does not exist. If not provided, it will be set to an empty table.
	</li>
	
</ul>





<div>


<h3>Return values:</h3>
<ol>
	
	<li>table with configuration loaded, or <code>defaults</code> if it failed. The returned table will have the <code>defaults</code> table set as its metatable, so any value not in the configfile will be returned from the defaults.</li>
	
	<li>2nd return value is an error message in case an error was encountered while loading the config file. NOTE: the configfile not existing is not considered an error.</li>
	
</ol>

</div>






<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="#upnp members and namespaces">
		upnp.configroot
	</a></li>
	
	<li><a href="../modules/upnp.html#upnp.existsconfigfile">
		upnp.existsconfigfile
	</a></li>
	
	<li><a href="../modules/upnp.html#upnp.writeconfigfile">
		upnp.writeconfigfile
	</a></li>
	
</ul>

</div>


</dd>




<dt><a name="upnp.startdevice"></a><strong>upnp.startdevice</strong>&nbsp;(rootdev)</dt>
<dd>
Starts a UPnP device. Registers the device with the lib to enable network comms and callbacks.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>rootdev</em></code>: device object, must be a root device with the <code>rootdev.devicexmlurl</code> set to the relative path within the <code>webroot</code> path, where the device description xml can be downloaded.
	</li>
	
</ul>





<div>


<h3 class="inline-block">Return value:</h3>
handle to the newly registered device or nil + error message

</div>







</dd>




<dt><a name="upnp.stopdevice"></a><strong>upnp.stopdevice</strong>&nbsp;(hdl)</dt>
<dd>
Stops a UPnP device. Unregisters the device with the lib to disable network comms and callbacks.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>hdl</em></code>: handle to the currently enabled device
	</li>
	
</ul>





<div>


<h3 class="inline-block">Return value:</h3>
1 on success, or <code>nil + error message</code>

</div>







</dd>




<dt><a name="upnp.subscribe"></a><strong>upnp.subscribe</strong>&nbsp;()</dt>
<dd>
Subscribe to events of upnp library. These are not individual device/service event, but library events.











<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="http://tieske.github.com/CopasTimer/">
		copas.eventer
	</a></li>
	
	<li><a href="../modules/upnp.html#upnp.events">
		upnp.events
	</a></li>
	
</ul>

</div>


</dd>




<dt><a name="upnp.unsubscribe"></a><strong>upnp.unsubscribe</strong>&nbsp;()</dt>
<dd>
Unsubscribe from events of upnp library.











<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="http://tieske.github.com/CopasTimer/">
		copas.eventer
	</a></li>
	
	<li><a href="../modules/upnp.html#upnp.events">
		upnp.events
	</a></li>
	
</ul>

</div>


</dd>




<dt><a name="upnp.writeconfigfile"></a><strong>upnp.writeconfigfile</strong>&nbsp;(configname, content, comment)</dt>
<dd>
Write a configfile. The configfile must be a string in Lua table format, starting with '<code> return {</code>' and ending with '<code>}</code>'.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>configname</em></code>: configuration filename to write to. This should only be a filename only (no path), and it will be stored in the <code>upnp.configroot</code> directory.
	</li>
	
	<li>
	  <code><em>content</em></code>: table; the content to write
	</li>
	
	<li>
	  <code><em>comment</em></code>: string (optional); text block to write at start of config file
	</li>
	
</ul>





<div>


<h3 class="inline-block">Return value:</h3>
1 on success, <code>nil + errormsg</code> upon failure

</div>






<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="#upnp members and namespaces">
		upnp.configroot
	</a></li>
	
	<li><a href="../modules/upnp.html#upnp.readconfigfile">
		upnp.readconfigfile
	</a></li>
	
	<li><a href="../modules/upnp.html#upnp.existsconfigfile">
		upnp.existsconfigfile
	</a></li>
	
</ul>

</div>


</dd>


</dl>


</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
    <p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->
</body>
</html>
